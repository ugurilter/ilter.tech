<!DOCTYPE html><html lang="en"> <head><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDSFLEY2WT"></script> <title>PWN - Questionaire</title><meta charset="UTF-8"><link rel="canonical" href="https://ilter.tech/posts/htb-pwn-questionnaire/"><meta name="description" content="HacktheBox CTF - Cyber Apocalypse"><meta name="robots" content="index, follow"><meta property="og:title" content="PWN - Questionaire"><meta property="og:type" content="website"><meta property="og:image" content="/opengraph-image.jpg"><meta property="og:url" content="https://ilter.tech/posts/htb-pwn-questionnaire/"><meta property="og:image:url" content="/opengraph-image.jpg"><meta property="og:image:alt" content="astro portfolio template image"><meta name="twitter:creator" content="@"><link rel="icon" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Astro v3.6.0" name="generator"><meta content="/opengraph-image.jpg" name="twitter:image"><meta content="summary_large_image" name="twitter:card"><meta content="PWN - Questionaire" name="twitter:title"><meta content="Personal portfolio of Ugur Ilter, a software engineer based in Turkey." name="twitter:description"><meta content="@" name="twitter:site"><link rel="stylesheet" href="/_astro/index.a5a40b1c.css" /><script type="module">const d={online:{mclass:"st-green",text:"online",cclass:"st-c-green",aniclass:"ani-bg-green"},offline:{mclass:"st-red",text:"offline",cclass:"st-c-red",aniclass:""},idle:{mclass:"st-orange",text:"idle",cclass:"st-c-orange",aniclass:"ani-bg-orange"},dnd:{mclass:"st-red",text:"DnD",cclass:"st-c-red",aniclass:"ani-bg-red"}};function l(e){const n=e.d.discord_status,s=document.getElementById("ani-circle"),a=d[n].aniclass??"";s.classList.remove("ani-bg-green","ani-bg-red","ani-bg-orange"),a!==""&&s.classList.add(a)}function r(e){const n=document.getElementById("listening");n.innerHTML=e.state+" - "+e.details}function g(e){const n=document.getElementById("playing");n.innerHTML=e.name}function m(e){const n=document.getElementById("working");n.innerHTML=e.state.split("Workspace: ")[1]+"<br/>"+e.details.split("Editing ")[1]}function u(e){const n=document.getElementById("st-tooltip");n.innerHTML=d[e].text??""}function c(){const e=document.getElementById("listening"),n=document.getElementById("playing"),s=document.getElementById("working");e.innerHTML="-",n.innerHTML="-",s.innerHTML="-"}function i(e){var n=JSON.parse(e);document.getElementById("profile-pic");const s=n.d.discord_status;u(s),l(n);const a=n.d.activities;c(),a.forEach(t=>{t.name==="YouTube Music"?r(t):t.name==="Visual Studio Code"?m(t):t.name&&!t.details&&g(t)})}document.addEventListener("DOMContentLoaded",function(){c();const e=new WebSocket("wss://api.lanyard.rest/socket");let n={subscribe_to_id:"144871706257784832"},s=new Map;e.onmessage=a=>{const t=JSON.parse(a.data);switch(t.op){case 1:{e.readyState==e.OPEN&&e.send(JSON.stringify({op:2,d:n})),setInterval(()=>{e.readyState==e.OPEN&&e.send(JSON.stringify({op:3}))},t.d.heartbeat_interval);break}case 0:switch(t.t){case"INIT_STATE":{s=new Map([[t.d.discord_user.id,t.d]]),i(a.data);break}case"PRESENCE_UPDATE":{s.set(t.d.discord_user.id,t.d),i(a.data);break}}}}});window.dataLayer=window.dataLayer||[];function o(){dataLayer.push(arguments)}o("js",new Date);o("config","G-PDSFLEY2WT");
</script></head><body class="mx-auto flex min-h-screen max-w-[1200px] flex-col gap-9 bg-neutral-950 px-10 py-8 text-sm text-neutral-400 md:gap-20 md:py-16"> <header class="z-40 flex w-full flex-col gap-2 md:flex-row md:justify-between"> <a href="mailto:ugur@ilter.tech" class="hover:text-neutral-100">ugur@ilter.tech</a> <nav role="navigation"> <ul role="list" class="flex flex-row gap-2"> <li> <a href="/" class="hover:text-neutral-100">Home</a> </li> <li>/</li> <li> <a href="/posts" class="hover:text-neutral-100">Posts</a> </li> <li>/</li> <li> <a href="/resume.pdf" class="hover:text-neutral-100">Resume</a> </li> </ul> </nav> </header> <div class="fixed z-0 h-[134px] w-[134px] lg:w-[300px] lg:h-[300px] rounded-full bg-orange-500 blur-[150px] md:blur-[350px] opacity-50 left-0 top-0"></div> <div class="fixed z-0 h-[134px] w-[134px] lg:w-[300px] lg:h-[300px] rounded-full bg-violet-500 blur-[150px] md:blur-[350px] opacity-50 right-0 bottom-0"></div>  <main class="post mx-auto flex w-full flex-col gap-4"> <header role="presentation"> <h1 class="text-md"> PWN - Questionaire - 21/03/2023 </h1> <p class="italic">HacktheBox CTF - Cyber Apocalypse</p> </header> <pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Questionnaire</span></span>
<span class="line"><span>It's time to learn some things about binaries and basic c. Connect to a remote server and answer some questions to get the flag.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Points: 300</span></span>
<span class="line"><span>Difficulty: Very Easy</span></span></code></pre>
<p>In this challenge you are given a docker instance and also some files that you can download.
There was 2 files inside the archive: ‘test’ and ‘test.c’.
After a quick glance at the C file i decided to run the given binary first which resulted in failure. Before i connected to the docker instance i also run ‘file’ and ‘checksec’ commands on the file.</p>
<p><img src="/images/htb/pwn/questionnaire/file_info.png" alt="HTB"></p>
<p>Since i couldn’t get much in my hands with a non-working binary, i decided to connect to the docker instance via netcat.</p>
<p>Once i connected i was welcomed by a wall of text followed by a series of questions that i had to answer one-by-one in order to reach the flag.</p>
<p>I already had the answers for first 4 questions since i already had my checks on the file: ‘64-bit’, ‘dynamic’, ‘not-stripped’ and ‘NX’</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  When compiling C/C++ source code in Linux, an ELF (Executable and Linkable Format) file is created.  ◉</span></span>
<span class="line"><span>◉  The flags added when compiling can affect the binary in various ways, like the protections.          ◉</span></span>
<span class="line"><span>◉  Another thing affected can be the architecture and the way it's linked.                              ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  If the system in which the challenge is compiled is x86_64 and no flag is specified,                 ◉</span></span>
<span class="line"><span>◉  the ELF would be x86-64 / 64-bit. If it's compiled with a flag to indicate the system,               ◉</span></span>
<span class="line"><span>◉  it can be x86 / 32-bit binary.                                                                       ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  To reduce its size and make debugging more difficult, the binary can be stripped or not stripped.    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Dynamic linking:                                                                                     ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  A pointer to the linked file is included in the executable, and the file contents are not included   ◉</span></span>
<span class="line"><span>◉  at link time. These files are used when the program is run.                                          ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Static linking:                                                                                      ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The code for all the routines called by your program becomes part of the executable file.            ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Stripped:                                                                                            ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The binary does not contain debugging information.                                                   ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Not Stripped:                                                                                        ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The binary contains debugging information.                                                           ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The most common protections in a binary are:                                                         ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Canary: A random value that is generated, put on the stack, and checked before that function is      ◉</span></span>
<span class="line"><span>◉  left again. If the canary value is not correct-has been changed or overwritten, the application will ◉</span></span>
<span class="line"><span>◉  immediately stop.                                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  NX: Stands for non-executable segments, meaning we cannot write and execute code on the stack.       ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  PIE: Stands for Position Independent Executable, which randomizes the base address of the binary     ◉</span></span>
<span class="line"><span>◉  as it tells the loader which virtual address it should use.                                          ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  RelRO: Stands for Relocation Read-Only. The headers of the binary are marked as read-only.           ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Run the 'file' command in the terminal and 'checksec' inside the debugger.                           ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The output of 'file' command:                                                                        ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  ✗ file test                                                                                          ◉</span></span>
<span class="line"><span>◉  test: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked,                       ◉</span></span>
<span class="line"><span>◉  interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5a83587fbda6ad7b1aeee2d59f027a882bf2a429,     ◉</span></span>
<span class="line"><span>◉  for GNU/Linux 3.2.0, not stripped.                                                                   ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The output of 'checksec' command:                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  gef➤  checksec                                                                                       ◉</span></span>
<span class="line"><span>◉  Canary                        : ✘                                                                    ◉</span></span>
<span class="line"><span>◉  NX                            : ✓                                                                    ◉</span></span>
<span class="line"><span>◉  PIE                           : ✘                                                                    ◉</span></span>
<span class="line"><span>◉  Fortify                       : ✘                                                                    ◉</span></span>
<span class="line"><span>◉  RelRO                         : Partial                                                              ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[*] Question number 0x1:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Is this a '32-bit' or '64-bit' ELF? (e.g. 1337-bit)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> 64-bit</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x2:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What's the linking of the binary? (e.g. static, dynamic)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> dynamic</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x3:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Is the binary 'stripped' or 'not stripped'?</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> not stripped</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x4:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Which protections are enabled (Canary, NX, PIE, Fortify)?</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> NX</span></span>
<span class="line"><span></span></span>
<span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Great job so far! Now it's time to see some C code and a binary file.                                ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  In the pwn_questionnaire.zip there are two files:                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  1. test.c                                                                                            ◉</span></span>
<span class="line"><span>◉  2. test                                                                                              ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The 'test.c' is the source code and 'test' is the output binary.                                     ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Let's start by analyzing the code.                                                                   ◉</span></span>
<span class="line"><span>◉  First of all, let's focus on the '#include &#x3C;stdio.h>' line.                                          ◉</span></span>
<span class="line"><span>◉  It includes the 'stdio.h' header file to use some of the standard functions like 'printf()'.         ◉</span></span>
<span class="line"><span>◉  The same principle applies for the '#include &#x3C;stdlib.h>' line, for other functions like 'system()'.  ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Now, let's take a closer look at:                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  void main(){                                                                                         ◉</span></span>
<span class="line"><span>◉      vuln();                                                                                          ◉</span></span>
<span class="line"><span>◉  }                                                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  By default, a binary file starts executing from the 'main()' function.                               ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  In this case, 'main()' only calls another function, 'vuln()'.                                        ◉</span></span>
<span class="line"><span>◉  The function 'vuln()' has 3 lines.                                                                   ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  void vuln(){                                                                                         ◉</span></span>
<span class="line"><span>◉      char buffer[0x20] = {0};                                                                         ◉</span></span>
<span class="line"><span>◉      fprintf(stdout, "\nEnter payload here: ");                                                       ◉</span></span>
<span class="line"><span>◉      fgets(buffer, 0x100, stdin);                                                                     ◉</span></span>
<span class="line"><span>◉  }                                                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  The first line declares a 0x20-byte buffer of characters and fills it with zeros.                    ◉</span></span>
<span class="line"><span>◉  The second line calls 'fprintf()' to print a message to stdout.                                      ◉</span></span>
<span class="line"><span>◉  Finally, the third line calls 'fgets()' to read 0x100 bytes from stdin and store them to the         ◉</span></span>
<span class="line"><span>◉  aformentioned buffer.                                                                                ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Then, there is a custom 'gg()' function which calls the standard 'system()' function to print the    ◉</span></span>
<span class="line"><span>◉  flag. This function is never called by default.                                                      ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  void gg(){                                                                                           ◉</span></span>
<span class="line"><span>◉      system("cat flag.txt");                                                                          ◉</span></span>
<span class="line"><span>◉  }                                                                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Run the 'man &#x3C;function_name>' command to see the manual page of a standard function (e.g. man fgets).◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span></code></pre>
<p>Looking at the C code, the custom function that gets called is ‘vuln’.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x5:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What is the name of the custom function that gets called inside `main()`? (e.g. vulnerable_function())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> vuln</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<p>The size of the buffer is ‘0x20’ (in hex) or ‘30’ (in decimal). Both answers work.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x6:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What is the size of the 'buffer' (in hex or decimal)?</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> 32</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<p>I checked the code and the function that never got called was named ‘gg()‘.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x7:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Which custom function is never called? (e.g. vuln())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> gg</span></span>
<span class="line"><span></span></span>
<span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Excellent! Now it's time to talk about Buffer Overflows.                                             ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Buffer Overflow means there is a buffer of characters, integers or any other type of variables,      ◉</span></span>
<span class="line"><span>◉  and someone inserts into this buffer more bytes than it can store.                                   ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  If the user inserts more bytes than the buffer's size, they will be stored somewhere in the memory   ◉</span></span>
<span class="line"><span>◉  after the address of the buffer, overwriting important addresses for the flow of the program.        ◉</span></span>
<span class="line"><span>◉  This, in most cases, will make the program crash.                                                    ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  When a function is called, the program knows where to return because of the 'return address'. If the ◉</span></span>
<span class="line"><span>◉  player overwrites this address, they can redirect the flow of the program wherever they want.        ◉</span></span>
<span class="line"><span>◉  To print a function's address, run 'p &#x3C;function_name>' inside 'gdb'. (e.g. p main)                   ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  gef➤  p gg                                                                                           ◉</span></span>
<span class="line"><span>◉  $1 = {&#x3C;text variable, no debug info>} 0x401176 &#x3C;gg>                                                  ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  To perform a Buffer Overflow in the simplest way, we take these things into consideration.           ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  1. Canary is disabled so it won't quit after the canary address is overwritten.                      ◉</span></span>
<span class="line"><span>◉  2. PIE is disabled so the addresses of the binary functions are not randomized and the user knows    ◉</span></span>
<span class="line"><span>◉     where to return after overwritting the return address.                                            ◉</span></span>
<span class="line"><span>◉  3. There is a buffer with N size.                                                                    ◉</span></span>
<span class="line"><span>◉  4. There is a function that reads to this buffer more than N bytes.                                  ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Run printf 'A%.0s' {1..30} | ./test to enter 30*"A" into the program.                                ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉  Run the program manually with "./test" and insert 30*A, then 39, then 40 and see what happens.       ◉</span></span>
<span class="line"><span>◉                                                                                                       ◉</span></span>
<span class="line"><span>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉</span></span></code></pre>
<p>In the code vulnerable function was ‘fgets’.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x8:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What is the name of the standard function that could trigger a Buffer Overflow? (e.g. fprintf())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> fgets</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<p>Segfault occured once i’ve sent 40 bytes of data.</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0x9:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Insert 30, then 39, then 40 'A's in the program and see the output.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>After how many bytes a Segmentation Fault occurs (in hex or decimal)?</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> 40</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span></code></pre>
<p>In order to get the address of gg i used command ‘objdump’.</p>
<p><img src="/images/htb/pwn/questionnaire/gg_addr.png" alt="HTB"></p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>[*] Question number 0xa:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>What is the address of 'gg()' in hex? (e.g. 0x401337)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>>> 0x401176</span></span>
<span class="line"><span></span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠      Correct      ♠</span></span>
<span class="line"><span>♠                   ♠</span></span>
<span class="line"><span>♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠ ♠</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Great job! It's high time you solved your first challenge! Here is the flag!</span></span></code></pre>
<p><img src="/images/htb/pwn/questionnaire/flag.png" alt="HTB"></p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Flag: HTB{th30ry_bef0r3_4cti0n}</span></span></code></pre> </main>    <link rel="stylesheet" href="https://rsms.me/inter/inter.css"> </body></html>